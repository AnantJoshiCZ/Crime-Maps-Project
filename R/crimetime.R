library(TTR)
library(forecast)
library(tseries)


CRM <- read.csv("C:/Users/Anant Joshi/Documents/CrimeData/data/Assault.csv", header = TRUE)
TSvector <- as.data.frame((CRM[35,2:14]))
CRM[35,2:14]
TSvector$X2003 <- (gsub(",","",TSvector$X2003))
TSvector$X2004 <- (gsub(",","",TSvector$X2004))
TSvector$X2005 <- (gsub(",","",TSvector$X2005))
TSvector$X2006 <- (gsub(",","",TSvector$X2006))
TSvector$X2007 <- (gsub(",","",TSvector$X2007))
TSvector$X2008 <- (gsub(",","",TSvector$X2008))
TSvector$X2009 <- (gsub(",","",TSvector$X2009))
TSvector$X2010 <- (gsub(",","",TSvector$X2010))
TSvector$X2011 <- (gsub(",","",TSvector$X2011))
TSvector$X2012 <- (gsub(",","",TSvector$X2012))
TSvector$X2013 <- (gsub(",","",TSvector$X2013))
TSvector$X2014 <- (gsub(",","",TSvector$X2014))
TSvector$X2015 <- (gsub(",","",TSvector$X2015))
TSvector <- as.numeric(TSvector)
CRMtimeseries <- ts(TSvector, frequency = 1, start = 2003, end = 2015)
plot.ts(CRMtimeseries)
adf.test(CRMtimeseries)
auto.arima(CRMtimeseries)
acf(CRMtimeseries, lag.max = 20)
pacf(CRMtimeseries, lag.max = 20)
CRMarimaseries <- arima(CRMtimeseries, order=c(3,1,1), include.mean = TRUE)
CRMforecastARIMA <- forecast(CRMarimaseries, h = 5)
plot(CRMforecastARIMA)

CRM <- read.csv("C:/Users/Anant Joshi/Documents/CrimeData/data/Theft.csv", header = TRUE)
TSvector <- as.data.frame((CRM[34,4:16]))
CRM[34,4:16]
TSvector$X2003 <- (gsub(",","",TSvector$X2003))
TSvector$X2004 <- (gsub(",","",TSvector$X2004))
TSvector$X2005 <- (gsub(",","",TSvector$X2005))
TSvector$X2006 <- (gsub(",","",TSvector$X2006))
TSvector$X2007 <- (gsub(",","",TSvector$X2007))
TSvector$X2008 <- (gsub(",","",TSvector$X2008))
TSvector$X2009 <- (gsub(",","",TSvector$X2009))
TSvector$X2010 <- (gsub(",","",TSvector$X2010))
TSvector$X2011 <- (gsub(",","",TSvector$X2011))
TSvector$X2012 <- (gsub(",","",TSvector$X2012))
TSvector$X2013 <- (gsub(",","",TSvector$X2013))
TSvector$X2014 <- (gsub(",","",TSvector$X2014))
TSvector$X2015 <- (gsub(",","",TSvector$X2015))
TSvector <- as.numeric(TSvector)
CRMtimeseries <- ts(TSvector, frequency = 1, start = 2003, end = 2015)
plot.ts(CRMtimeseries)
adf.test(CRMtimeseries)
auto.arima(CRMtimeseries)
acf(CRMtimeseries, lag.max = 20)
pacf(CRMtimeseries, lag.max = 20)
CRMarimaseries <- arima(CRMtimeseries, order=c(2,1,1))
CRMforecastARIMA <- forecast(CRMarimaseries, h = 5)
plot(CRMforecastARIMA)


CRM <- read.csv("C:/Users/Anant Joshi/Documents/CrimeData/data/kidnapping.csv", header = TRUE)
TSvector <- as.data.frame((CRM[101,4:16]))
CRM[101,4:16]
TSvector$X2003 <- (gsub(",","",TSvector$X2003))
TSvector$X2004 <- (gsub(",","",TSvector$X2004))
TSvector$X2005 <- (gsub(",","",TSvector$X2005))
TSvector$X2006 <- (gsub(",","",TSvector$X2006))
TSvector$X2007 <- (gsub(",","",TSvector$X2007))
TSvector$X2008 <- (gsub(",","",TSvector$X2008))
TSvector$X2009 <- (gsub(",","",TSvector$X2009))
TSvector$X2010 <- (gsub(",","",TSvector$X2010))
TSvector$X2011 <- (gsub(",","",TSvector$X2011))
TSvector$X2012 <- (gsub(",","",TSvector$X2012))
TSvector$X2013 <- (gsub(",","",TSvector$X2013))
TSvector$X2014 <- (gsub(",","",TSvector$X2014))
TSvector$X2015 <- (gsub(",","",TSvector$X2015))
TSvector <- as.numeric(TSvector)
CRMtimeseries <- ts(TSvector, frequency = 1, start = 2003, end = 2015)
plot.ts(CRMtimeseries)
adf.test(CRMtimeseries)
auto.arima(CRMtimeseries)
acf(CRMtimeseries, lag.max = 20)
pacf(CRMtimeseries, lag.max = 20)
CRMarimaseries <- arima(CRMtimeseries, order=c(1,1,1))
CRMforecastARIMA <- forecast(CRMarimaseries, h = 5)
plot(CRMforecastARIMA)
